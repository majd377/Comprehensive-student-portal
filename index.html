<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Ø£Ø¶Ù Ù‚Ø¨Ù„ </head> -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
    <style>
        :root {
            --primary-color: #000000;
            --secondary-color: #ceb132;
            --accent-color: #f59e0b;
            --bg-color: #fff9ef;
            --card-bg: #ffe8aa;
            --text-color: #000000;
            --text-light: #6b7280;
            --success: #10b981;
            --danger: #ef4444;
            --radius: 10px;
            --shadow: 0 6px 8px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 200px;
            background-color: var(--card-bg);
            padding: 20px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100%;
            right: 0;
            top: 0;
            box-shadow: -2px 0 10px rgba(0,0,0,0.05);
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .logo {
            font-size: 1.09rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .nav-links {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .nav-item {
            padding: 12px 15px;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-light);
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background-color: #eff6ff;
            color: var(--primary-color);
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
        }

        /* Main Content */
        .main-content {
            margin-right: 250px;
            padding: 30px;
            width: 100%;
            transition: margin 0.3s ease;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .page-title p {
            color: var(--text-light);
        }

        .admin-toggle {
            background-color: var(--text-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .admin-toggle.active {
            background-color: var(--accent-color);
        }

        /* Sections Grid (Home) */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.2s;
            border: 2px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }

        .feature-icon {
            width: 50px;
            height: 50px;
            background-color: #eff6ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        /* Section Selector */
        .section-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e5e7eb;
        }

        .sec-btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
        }

        .sec-btn:hover, .sec-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Content Lists & Cards */
        .content-area {
            display: none;
            animation: fadeIn 0.3s;
        }

        .content-area.active {
            display: block;
        }

        .data-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 15px;
        }

        .data-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        /* Progress Bars */
        .progress-container {
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 10px;
            height: 10px;
            margin-top: 8px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--success);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Inputs in Edit Mode */
        .editable-input, .editable-textarea {
            border: 1px dashed var(--accent-color);
            padding: 8px;
            border-radius: 4px;
            background: #fffbeb;
            width: 100%;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        /* Logic for hiding/showing edit fields */
        body:not(.edit-mode) .editable-field { display: none !important; }
        body:not(.edit-mode) .add-new-container { display: none !important; }
        body:not(.edit-mode) .btn-delete { display: none !important; }
        
        body.edit-mode .editable-value { display: none !important; }
        body.edit-mode .editable-field { display: block !important; }
        body.edit-mode .add-new-container { display: block !important; }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            border: none;
            color: white;
            margin-top: 5px;
        }
        
        .btn-save { background-color: var(--success); }
        .btn-delete { background-color: var(--danger); margin-right: auto; }
        .btn-add { background-color: var(--primary-color); margin-top: 15px; width: 100%; padding: 10px; }
        .btn-link { background-color: var(--primary-color); text-decoration: none; display: inline-block; padding: 5px 15px; border-radius: 4px; color: white; font-size: 0.9rem;}

        /* Assignments Checkbox */
        .task-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
            background: white;
            border-radius: 8px;
            margin-bottom: 10px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .task-item.completed span {
            text-decoration: line-through;
            color: #9ca3af;
        }

        .task-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        .add-new-container {
            background: #f8fafc;
            padding: 20px;
            border-radius: var(--radius);
            margin-top: 20px;
            border: 2px dashed #cbd5e1;
        }

        /* LOGIN MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .modal-box {
            background: white;
            padding: 25px;
            border-radius: var(--radius);
            width: 90%;
            max-width: 350px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            text-align: center;
        }

        .modal-box h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .modal-input {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
        }

        .modal-btns {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-login { background: var(--primary-color); color: white; flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer;}
        .btn-cancel { background: #e5e7eb; color: #374151; flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer;}

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar { transform: translateX(100%); }
            .sidebar.open { transform: translateX(0); }
            .main-content { margin-right: 0; padding: 15px; }
            .data-card .data-header { flex-direction: column; align-items: flex-start; gap:8px; }
            .data-card .data-header h3 { font-size: 1.05rem; }
            .session-info { font-size: 0.82rem; margin-top:4px; }
            .data-card .btn-link { padding: 6px 10px; font-size: 0.85rem; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

    <nav class="sidebar" id="sidebar">
        <div class="logo">
            <span>ğŸ“</span> Ù…Ù†ØµØªÙŠ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ©
        </div>
        <ul class="nav-links">
            <li class="nav-item active" onclick="showSection('home')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </li>
            <li class="nav-item" onclick="showSection('live-links')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="2"></circle><path d="M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14"></path></svg>
                Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø­ØµØµ
            </li>
            <li class="nav-item" onclick="showSection('progress')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ø§Ù„Ù…Ù†Ù‡Ø¬
            </li>
            <li class="nav-item" onclick="showSection('assignments')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª
            </li>
            <li class="nav-item" onclick="showSection('support')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¯Ø¹Ù…
            </li>
            <li class="nav-item" onclick="showSection('summaries')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                Ø§Ù„ØªÙ„Ø®ÙŠØµØ§Øª
            </li>
            
            <li class="nav-item" onclick="showSection('news')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path></svg>
                Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±
            </li>
            <li class="nav-item" onclick="showSection('books-packages')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="7" width="18" height="13" rx="2"></rect>
                    <path d="M16 3v4"></path>
                    <path d="M8 3v4"></path>
                </svg>
                Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù…
            </li>
            <li class="nav-item" onclick="showSection('important-links')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg>
                Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø©
            </li>
            <li class="nav-item" onclick="showSection('about-team')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±
            </li>
        </ul>
    </nav>

    <main class="main-content">
        <div class="header">
            <div class="page-title">
                <h1 id="page-heading">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h1>
                <p id="current-date">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ§Ø±ÙŠØ®...</p>
            </div>
            <button class="admin-toggle" id="adminBtn" onclick="requestEditMode()">
                <span id="adminIcon">ğŸ”’</span> <span id="adminText">ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©</span>
            </button>
        </div>

        <div id="loginModal" class="modal-overlay">
            <div class="modal-box">
                <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h3>
                <form id="adminLoginForm" autocomplete="on" onsubmit="checkLogin(event)">
                    <input type="text" id="usernameInput" name="username" class="modal-input" autocomplete="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                    <input type="password" id="passwordInput" name="password" class="modal-input" autocomplete="current-password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                    <p id="loginError" style="color:red; font-size:0.8rem; display:none;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©</p>
                    <div class="modal-btns">
                        <button type="button" class="btn-cancel" onclick="closeLoginModal()">Ø¥Ù„ØºØ§Ø¡</button>
                        <button type="submit" class="btn-login">Ø¯Ø®ÙˆÙ„</button>
                    </div>
                </form>
            </div>
        </div>

        <div id="home" class="content-area active">
            <div class="dashboard-grid">
                <div class="feature-card" onclick="showSection('live-links')">
                    <div class="feature-icon">ğŸ”—</div>
                    <h3>Ø­ØµØµ Ø§Ù„ÙŠÙˆÙ…</h3>
                    <p>Ø±ÙˆØ§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ø²ÙˆÙ… Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª</p>
                </div>
                <div class="feature-card" onclick="showSection('progress')">
                    <div class="feature-icon">ğŸ“Š</div>
                    <h3>Ø§Ù„ØªÙ‚Ø¯Ù… Ø¨Ø§Ù„Ù…Ù†Ù‡Ø¬</h3>
                    <p>ØªØ§Ø¨Ø¹ ÙˆØµÙˆÙ„Ùƒ ÙÙŠ ÙƒÙ„ Ù…Ø§Ø¯Ø© Ù„ÙƒÙ„ Ø´Ø¹Ø¨Ø©</p>
                </div>
                <div class="feature-card" onclick="showSection('assignments')">
                    <div class="feature-icon">ğŸ“</div>
                    <h3>Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</h3>
                    <p>Ø³Ø¬Ù„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§</p>
                </div>
                <div class="feature-card" onclick="showSection('support')">
                    <div class="feature-icon">ğŸ“</div>
                    <h3>Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¯Ø¹Ù…</h3>
                    <p>ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©</p>
                </div>
                <div class="feature-card" onclick="showSection('summaries')">
                    <div class="feature-icon">ğŸ“š</div>
                    <h3>Ø§Ù„ØªÙ„Ø®ÙŠØµØ§Øª ÙˆØ§Ù„Ù…Ù„ÙØ§Øª</h3>
                    <p>Ù†Ø²Ù‘Ù„ Ù…Ù„ÙØ§Øª Ø§Ù„ØªÙ„Ø®ÙŠØµ Ø§Ù„Ù…Ù‡Ù…Ø©</p>
                </div>
                
                <div class="feature-card" onclick="showSection('news')">
                    <div class="feature-icon">ğŸ“°</div>
                    <h3>Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±</h3>
                    <p>ØªØ§Ø¨Ø¹ Ø£Ø­Ø¯Ø« Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                </div>
                <div class="feature-card" onclick="showSection('books-packages')">
                    <div class="feature-icon">ğŸ“¦</div>
                    <h3>Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù…</h3>
                    <p>ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù… Ø¨Ø³Ù‡ÙˆÙ„Ø©</p>
                </div>
                <div class="feature-card" onclick="showSection('important-links')">
                    <div class="feature-icon">ğŸŒ·</div>
                    <h3>Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø©</h3>
                    <p>Ø£ÙØ¶Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ø±</p>
                </div>
                <div class="feature-card" onclick="showSection('about-team')">
                    <div class="feature-icon">ğŸ¤ </div>
                    <h3>ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±</h3>
                    <p>Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§...</p>
                </div>
            </div>
        </div>

        <div id="progress" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div class="section-selector" id="progress-sec-selector"></div>
            <div id="progress-list"></div>
        </div>

        <div id="assignments" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div class="section-selector" id="assign-sec-selector"></div>
            <div id="assignments-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ø¨ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h4>
                <input type="text" id="new-assignment-text" class="editable-input" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨ Ù‡Ù†Ø§...">
                <button class="btn-sm btn-add" onclick="addAssignment()">Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø¬Ø¨</button>
            </div>
        </div>

        <div id="support" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div id="support-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø¯Ø¹Ù… Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-support-name" class="editable-input" placeholder="Ø§Ù„Ø§Ø³Ù… / Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„" style="margin-bottom: 10px;">
                <input type="text" id="new-support-role" class="editable-input" placeholder="Ø§Ù„Ø¯ÙˆØ± / Ø§Ù„ÙˆØ¸ÙŠÙØ©" style="margin-bottom: 10px;">
                <input type="text" id="new-support-num" class="editable-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
                <button class="btn-sm btn-add" onclick="addSupport()">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>

        <div id="summaries" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div id="summaries-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-summ-title" class="editable-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù / Ø§Ù„Ù…Ø§Ø¯Ø©" style="margin-bottom: 10px;">
                <input type="text" id="new-summ-link" class="editable-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Google Drive Ù…Ø«Ù„Ø§Ù‹)">
                <button class="btn-sm btn-add" onclick="addSummary()">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>

        <div id="live-links" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div class="section-selector" id="live-sec-selector"></div>
            <div id="live-list"></div>
        </div>

        <div id="news" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div id="news-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© Ø®Ø¨Ø± Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-news-title" class="editable-input" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø¨Ø±" style="margin-bottom: 10px;">
                <textarea id="new-news-content" class="editable-textarea" placeholder="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø®Ø¨Ø±..." style="min-height: 100px; margin-bottom: 10px;"></textarea>
                <button class="btn-sm btn-add" onclick="addNews()">Ø¥Ø¶Ø§ÙØ© Ø®Ø¨Ø±</button>
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
        <div id="books-packages" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button id="booksTab" class="sec-btn active" onclick="switchBooksPackagesType('books')">ğŸ“– Ø§Ù„ÙƒØªØ¨</button>
                <button id="packagesTab" class="sec-btn" onclick="switchBooksPackagesType('packages')">ğŸ“¦ Ø§Ù„Ø±Ø²Ù…</button>
            </div>
            <div id="books-packages-list"></div>
            <div class="add-new-container">
                <h4 id="add-books-packages-title">Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-books-packages-title" class="editable-input" placeholder="Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨ Ø£Ùˆ Ø§Ù„Ø±Ø²Ù…Ø©" style="margin-bottom: 10px;">
                <input type="text" id="new-books-packages-link" class="editable-input" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„">
                <button class="btn-sm btn-add" onclick="addBooksPackage()">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>

        <div id="important-links" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div id="important-links-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù…Ù‡Ù… Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-link-title" class="editable-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ø±Ø§Ø¨Ø· / Ø§Ù„Ù…ÙˆØ¶ÙˆØ¹" style="margin-bottom: 10px;">
                <input type="text" id="new-link-url" class="editable-input" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· (URL)">
                <button class="btn-sm btn-add" onclick="addImportantLink()">Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø·</button>
            </div>
        </div>

        <div id="about-team" class="content-area">
            <button class="btn-link" style="margin-bottom:15px;" onclick="goBack()" id="backBtn">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
            <div id="team-list"></div>
            <div class="add-new-container">
                <h4>Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ ÙØ±ÙŠÙ‚ ØªØ·ÙˆÙŠØ± Ø¬Ø¯ÙŠØ¯</h4>
                <input type="text" id="new-team-name" class="editable-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" style="margin-bottom: 10px;">
                <input type="text" id="new-team-role" class="editable-input" placeholder="Ø§Ù„Ø¯ÙˆØ± / Ø§Ù„ØªØ®ØµØµ" style="margin-bottom: 10px;">
                <textarea id="new-team-bio" class="editable-textarea" placeholder="ÙˆØµÙ Ø§Ù„Ø¹Ø¶Ùˆ Ø£Ùˆ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©..." style="min-height: 60px; margin-bottom: 10px;"></textarea>
                <input type="text" id="new-team-whatsapp" class="editable-input" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨">
                <button class="btn-sm btn-add" onclick="addTeamMember()">Ø¥Ø¶Ø§ÙØ© Ø¹Ø¶Ùˆ</button>
            </div>
        </div>

    </main>

    <script>
        // --- Firebase Config ---
        const firebaseConfig = {
          apiKey: "AIzaSyB9gImjYRL8ymrCPiJAWkGTWv0vMv6eM08",
          authDomain: "mycollegeapp-e5362.firebaseapp.com",
          databaseURL: "https://mycollegeapp-e5362-default-rtdb.firebaseio.com",
          projectId: "mycollegeapp-e5362",
          storageBucket: "mycollegeapp-e5362.firebasestorage.app",
          messagingSenderId: "552090112014",
          appId: "1:552090112014:web:1bbfb4422cf86c1249ac5f",
          measurementId: "G-X35BQLF0C2"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
    </script>

    <script>
        // --- ADMIN CREDENTIALS ---
        // ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ù† Ù‡Ù†Ø§
        const ADMIN_USER = "admin";
        const ADMIN_PASS = "*100200300*"; // ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©

        // --- DATA INITIALIZATION ---
        const defaultData = {
            sections: 13,
            subjects: ["Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª", "Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡", "Ø§Ù„ÙƒÙŠÙ…ÙŠØ§Ø¡", "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", "Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", "Ø¹Ù„ÙˆÙ… Ø§Ù„Ø­Ø§Ø³ÙˆØ¨", "Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ÙŠØ©"],
            progress: {}, 
            assignments: {},
            support: [
                { id: 1, name: "Ø£. Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯", role: "Ù…Ø´Ø±Ù Ø§Ù„Ø´Ø¹Ø¨ Ø§Ù„Ø¹Ù„Ù…ÙŠ", phone: "0790000000" },
                { id: 2, name: "Ø£. Ø³Ø§Ø±Ø© Ø¹Ù„ÙŠ", role: "Ø¯Ø¹Ù… ÙÙ†ÙŠ", phone: "0780000000" }
            ],
            summaries: [
                { id: 1, title: "Ù…Ù„Ø®Øµ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„", link: "#" },
                { id: 2, title: "Ø´Ø±Ø­ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Unit 1", link: "#" }
            ],
            liveLinks: {},
            news: [
                { id: 1, title: "Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø³Ù†Ø© Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©", content: "Ù†ØªÙ…Ù†Ù‰ Ø¹Ø§Ù…Ø§Ù‹ Ø¯Ø±Ø§Ø³ÙŠØ§Ù‹ Ù…Ù…ÙŠØ²Ø§Ù‹ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø·Ø§Ù„Ø¨Ø§Øª" },
                { id: 2, title: "ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¬Ø¯ÙŠØ¯", content: "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¯Ø±Ø§Ø³ÙŠ Ù„Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ" }
            ],
            importantLinks: [
                { id: 1, title: "Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©", url: "#" },
                { id: 2, title: "Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©", url: "#" }
            ],
            team: [
                { id: 1, name: "Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯", role: "Ù…Ø¯ÙŠØ± Ø§Ù„Ù…ÙˆÙ‚Ø¹", bio: "Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¹Ø§Ù…", whatsapp: "0790000001" },
                { id: 2, name: "Ù„ÙŠÙ„Ù‰ Ø¹Ù„ÙŠ", role: "Ù…ØµÙ…Ù…Ø© ÙˆØ§Ø¬Ù‡Ø§Øª", bio: "Ù…Ø³Ø¤ÙˆÙ„Ø© ØªØµÙ…ÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª ÙˆØ§Ù„ØªØ¬Ø±Ø¨Ø©", whatsapp: "0790000002" }
            ],
            books: [
                { id: 1, title: "ÙƒØªØ§Ø¨ Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„", link: "#" },
                { id: 2, title: "ÙƒØªØ§Ø¨ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ - Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„", link: "#" }
            ],
            packages: [
                { id: 1, title: "Ø±Ø²Ù…Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„", link: "#" },
                { id: 2, title: "Ø±Ø²Ù…Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©", link: "#" }
            ]
        };

        // Initialize dummy data
        for (let i = 1; i <= defaultData.sections; i++) {
            if(!defaultData.progress[i]) defaultData.progress[i] = {};
            if(!defaultData.assignments[i]) defaultData.assignments[i] = [];
            if(!defaultData.liveLinks[i]) defaultData.liveLinks[i] = {};
            
                defaultData.subjects.forEach(sub => {
                    defaultData.progress[i][sub] = { current: 1, total: 20 };
                    defaultData.liveLinks[i][sub] = { link: "", from: "", to: "" };
                });
        }

        // Normalize appData to ensure required structures exist
        function normalizeAppData(data) {
            if(!data) return defaultData;
            // basic fallbacks
            if(!data.sections) data.sections = defaultData.sections;
            if(!data.subjects) data.subjects = defaultData.subjects.slice();
            if(!data.progress) data.progress = {};
            if(!data.assignments) data.assignments = {};
            if(!data.liveLinks) data.liveLinks = {};
            if(!data.support) data.support = defaultData.support.slice();
            if(!data.summaries) data.summaries = defaultData.summaries.slice();
            if(!data.liveLinks) data.liveLinks = {};
            if(!data.news) data.news = defaultData.news.slice();
            if(!data.importantLinks) data.importantLinks = defaultData.importantLinks.slice();
            if(!data.team) data.team = defaultData.team.slice();
            if(!data.books) data.books = defaultData.books.slice();
            if(!data.packages) data.packages = defaultData.packages.slice();

            // ensure team members have bio
            data.team.forEach(m => { if(!m.bio) m.bio = ''; });

            // ensure per-section structures
            for (let i = 1; i <= data.sections; i++) {
                if(!data.progress[i]) data.progress[i] = {};
                if(!data.assignments[i]) data.assignments[i] = [];
                if(!data.liveLinks[i]) data.liveLinks[i] = {};
                data.subjects.forEach(sub => {
                    if(!data.progress[i][sub]) data.progress[i][sub] = { current: 1, total: 20 };
                    // normalize liveLinks entry to object with link/from/to
                    if(!data.liveLinks[i][sub] || typeof data.liveLinks[i][sub] !== 'object') data.liveLinks[i][sub] = { link: "", from: "", to: "" };
                });
            }

            return data;
        }

        let appData = normalizeAppData(JSON.parse(localStorage.getItem('collegeAppData')) || defaultData);

        let currentView = 'home';
        let selectedSection = 1;
        let isEditMode = false;
        let isSyncingFromFirebase = false; // Ø¹Ù„Ù… Ù„Ù…Ù†Ø¹ recursion
        let lastLocalSave = 0; // Ø·Ø§Ø¨Ø¹ Ø²Ù…Ù†ÙŠ Ù„Ø¢Ø®Ø± Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ

        // --- Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¯ÙˆØ§Ù„ Ø§Ù„Ø­ÙØ¸ ÙˆØ§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù€ Firebase ---
        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Firebase
        function saveData() {
            // Ø¶Ø¹ Ø·Ø§Ø¨Ø¹Ù‹Ø§ Ø²Ù…Ù†ÙŠÙ‹Ø§ Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¹Ù† ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
            appData.__updated = Date.now();
            lastLocalSave = appData.__updated;
            db.ref('appData').set(appData, (error) => {
                if (error) {
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­ÙØ¸!');
                }
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Firebase Ø¹Ù†Ø¯ Ø£ÙŠ ØªØºÙŠÙŠØ±
        db.ref('appData').on('value', (snapshot) => {
            isSyncingFromFirebase = true;
            if (snapshot.exists()) {
                const data = snapshot.val();
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù…Ø·Ø§Ø¨Ù‚Ù‹Ø§ Ù„Ø¢Ø®Ø± Ø­ÙØ¸ Ù…Ø­Ù„ÙŠØŒ Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„ÙƒÙ† Ù†ØªØ¬Ù†Ø¨ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                if (data.__updated && data.__updated === lastLocalSave) {
                    appData = normalizeAppData(data);
                    render();
                    isSyncingFromFirebase = false;
                    return;
                }
                appData = normalizeAppData(data);
            } else {
                // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§ØªØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                appData = normalizeAppData(defaultData);
                saveData();
            }
            render();
            isSyncingFromFirebase = false;
        });

        // Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„ Ù„Ù„ØµÙØ­Ø©ØŒ Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ FirebaseØŒ Ø§Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        db.ref('appData').once('value').then((snapshot) => {
            if (!snapshot.exists()) {
                db.ref('appData').set(defaultData);
            }
        });

        function requestEditMode() {
            // If already in edit mode, just switch back to view (lock it)
            if(isEditMode) {
                toggleEditMode(false);
            } else {
                // Open the modal
                document.getElementById('loginModal').style.display = 'flex';
                document.getElementById('loginError').style.display = 'none';
                document.getElementById('usernameInput').value = '';
                document.getElementById('passwordInput').value = '';
                document.getElementById('usernameInput').focus();
            }
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
        }

        function checkLogin(e) {
            if(e && e.preventDefault) e.preventDefault();
            const user = document.getElementById('usernameInput').value;
            const pass = document.getElementById('passwordInput').value;

            if (user === ADMIN_USER && pass === ADMIN_PASS) {
                closeLoginModal(); // Ø£ØºÙ„Ù‚ Ø§Ù„Ù…ÙˆØ¯Ø§Ù„ ÙÙˆØ±Ø§Ù‹
                toggleEditMode(true);
                // If browser offered to save credentials, it will do so after a successful form submit.
            } else {
                document.getElementById('loginError').style.display = 'block';
            }
        }

        function toggleEditMode(enable) {
            isEditMode = enable;
            const btn = document.getElementById('adminBtn');
            const icon = document.getElementById('adminIcon');
            const text = document.getElementById('adminText');
            
            if(isEditMode) {
                document.body.classList.add('edit-mode');
                btn.classList.add('active');
                icon.innerText = 'ğŸ”“';
                text.innerText = 'ÙˆØ¶Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ (Ù†Ø´Ø·)';
            } else {
                document.body.classList.remove('edit-mode');
                btn.classList.remove('active');
                icon.innerText = 'ğŸ”’';
                text.innerText = 'ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©';
            }
            render(); 
        }

        // --- NAVIGATION ---

        let sectionHistory = [];

        function showSection(sectionId) {
            if (currentView !== sectionId) {
                sectionHistory.push(currentView);
            }
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const activeNav = Array.from(document.querySelectorAll('.nav-item')).find(el => el.getAttribute('onclick').includes(sectionId));
            if(activeNav) activeNav.classList.add('active');

            document.querySelectorAll('.content-area').forEach(el => el.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            currentView = sectionId;
            const titles = {
                'home': 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                'progress': 'Ø§Ù„Ø±Ø²Ù… ÙˆØ§Ù„Ù…Ù†Ù‡Ø¬',
                'assignments': 'Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª',
                'support': 'Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¯Ø¹Ù…',
                'summaries': 'Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆØ§Ù„ØªÙ„Ø®ÙŠØµØ§Øª',
                'live-links': 'Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø­ØµØµ',
                'news': 'Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±',
                'books-packages': 'Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù…',
                'important-links': 'Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø©',
                'about-team': 'ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±'
            };
            document.getElementById('page-heading').innerText = titles[sectionId];
            render();
        }

        function goBack() {
            if (sectionHistory.length > 0) {
                const prev = sectionHistory.pop();
                showSection(prev);
            } else {
                showSection('home');
            }
        }

        // --- Ø¯Ø§Ù„Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ---
        function setSection(sectionNum) {
            selectedSection = sectionNum;
            renderSectionSelectors();
            render();
        }

        // Ø¯Ø¹Ù… Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ø¬ÙˆØ§Ù„ (Ù…Ø«Ù„Ø« Ø§Ù„Ø±Ø¬ÙˆØ¹)
        window.addEventListener('popstate', function() {
            goBack();
        });

        // --- RENDER FUNCTIONS ---

        function render() {
            renderDate();
            renderSectionSelectors();
            if(currentView === 'progress') renderProgress();
            if(currentView === 'assignments') renderAssignments();
            if(currentView === 'support') renderSupport();
            if(currentView === 'summaries') renderSummaries();
            if(currentView === 'live-links') renderLiveLinks();
            if(currentView === 'news') renderNews();
            if(currentView === 'books-packages') renderBooksPackages();
            if(currentView === 'important-links') renderImportantLinks();
            if(currentView === 'about-team') renderTeam();
        }

        function renderDate() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const date = new Date().toLocaleDateString('ar-EG', options);
            document.getElementById('current-date').innerText = date;
        }

        function renderSectionSelectors() {
            const ids = ['progress-sec-selector', 'assign-sec-selector', 'live-sec-selector'];
            ids.forEach(id => {
                const container = document.getElementById(id);
                if(!container) return;
                container.innerHTML = '';
                for(let i=1; i<=appData.sections; i++) {
                    const btn = document.createElement('button');
                    btn.className = `sec-btn ${selectedSection === i ? 'active' : ''}`;
                    btn.innerText = `Ø´Ø¹Ø¨Ø© ${i}`;
                    btn.onclick = () => setSection(i);
                    container.appendChild(btn);
                }
            });
        }

        // --- SPECIFIC SECTION LOGIC ---

        function renderProgress() {
            const container = document.getElementById('progress-list');
            container.innerHTML = '';
            const sectionData = appData.progress[selectedSection] || {};
            
            appData.subjects.forEach(sub => {
                const data = sectionData[sub] || { current: 0, total: 10 };
                const percent = Math.min(100, Math.round((data.current / data.total) * 100));

                const card = document.createElement('div');
                card.className = 'data-card';
                card.innerHTML = `
                    <div class="data-header">
                        <h3>${sub}</h3>
                        <div class="editable-value">Ø¯Ø±Ø³ ${data.current} Ù…Ù† ${data.total}</div>
                    </div>
                    <div class="editable-field">
                        <label>Ø§Ù„Ø¯Ø±Ø³ Ø§Ù„Ø­Ø§Ù„ÙŠ:</label>
                        <input type="number" class="editable-input" value="${data.current}" onchange="updateProgress('${sub}', 'current', this.value)">
                        <label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø±ÙˆØ³:</label>
                        <input type="number" class="editable-input" value="${data.total}" onchange="updateProgress('${sub}', 'total', this.value)">
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" style="width: ${percent}%"></div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function updateProgress(subject, field, value) {
            if(!appData.progress[selectedSection]) appData.progress[selectedSection] = {};
            if(!appData.progress[selectedSection][subject]) appData.progress[selectedSection][subject] = {};
            appData.progress[selectedSection][subject][field] = parseInt(value);
            saveData();
            render();
        }

        function renderAssignments() {
            const container = document.getElementById('assignments-list');
            container.innerHTML = '';
            const tasks = appData.assignments[selectedSection] || [];
            
            if(tasks.length === 0) {
                container.innerHTML = '<p style="color:var(--text-light); text-align:center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ§Ø¬Ø¨Ø§Øª Ù…Ø³Ø¬Ù„Ø© Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø¹Ø¨Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.</p>';
                return;
            }

            tasks.forEach((task, index) => {
                const div = document.createElement('div');
                div.className = `task-item ${task.done ? 'completed' : ''}`;
                div.innerHTML = `
                    <input type="checkbox" ${task.done ? 'checked' : ''} onchange="toggleTask(${index})">
                    <span class="editable-value">${task.text}</span>
                    <input type="text" class="editable-field editable-input" value="${task.text}" onchange="updateTaskText(${index}, this.value)">
                    <button class="btn-sm btn-delete" onclick="deleteTask(${index})">Ø­Ø°Ù</button>
                `;
                container.appendChild(div);
            });
        }

        function addAssignment() {
            const text = document.getElementById('new-assignment-text').value;
            console.log('addAssignment called, section=', selectedSection, 'text=', text);
            if(text) {
                if(!appData.assignments[selectedSection]) appData.assignments[selectedSection] = [];
                appData.assignments[selectedSection].push({ id: Date.now(), text: text, done: false });
                document.getElementById('new-assignment-text').value = '';
                saveData();
                render();
                // ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                try { renderAssignments(); } catch(e) { console.warn('renderAssignments error', e); }
            }
        }

        function toggleTask(index) {
            appData.assignments[selectedSection][index].done = !appData.assignments[selectedSection][index].done;
            saveData();
            render();
        }
        function updateTaskText(index, val) { appData.assignments[selectedSection][index].text = val; saveData(); render(); }
        function deleteTask(index) { if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙˆØ§Ø¬Ø¨ØŸ')) { appData.assignments[selectedSection].splice(index, 1); saveData(); render(); } }

        function renderSupport() {
            const container = document.getElementById('support-list');
            container.innerHTML = '';
            appData.support.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <div>
                            <h3 class="editable-value">${item.name}</h3>
                            <input class="editable-field editable-input" value="${item.name}" onchange="updateSupport(${index}, 'name', this.value)">
                            <p class="editable-value" style="color:gray; font-size:0.9rem">${item.role}</p>
                            <input class="editable-field editable-input" value="${item.role}" onchange="updateSupport(${index}, 'role', this.value)">
                        </div>
                        <div style="text-align:left;">
                            <a href="tel:${item.phone}" class="btn-link editable-value">Ø§ØªØµØ§Ù„</a>
                            <input class="editable-field editable-input" value="${item.phone}" onchange="updateSupport(${index}, 'phone', this.value)">
                        </div>
                    </div>
                    <button class="btn-sm btn-delete" onclick="deleteSupport(${index})">Ø­Ø°Ù Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„</button>
                `;
                container.appendChild(div);
            });
        }

        function addSupport() {
            const name = document.getElementById('new-support-name').value;
            const role = document.getElementById('new-support-role').value;
            const phone = document.getElementById('new-support-num').value;
            if(name && phone) { 
                appData.support.push({ id: Date.now(), name, role, phone }); 
                document.getElementById('new-support-name').value=''; 
                document.getElementById('new-support-role').value=''; 
                document.getElementById('new-support-num').value=''; 
                saveData();
                render();
            }
        }
        function updateSupport(index, key, val) { appData.support[index][key] = val; saveData(); render(); }
        function deleteSupport(index) { if(confirm('Ø­Ø°Ù Ø¬Ù‡Ø© Ø§Ù„Ø§ØªØµØ§Ù„ØŸ')) { appData.support.splice(index, 1); saveData(); render(); } }

        function renderSummaries() {
            const container = document.getElementById('summaries-list');
            container.innerHTML = '';
            appData.summaries.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <div>
                            <h3 class="editable-value">${item.title}</h3>
                            <input class="editable-field editable-input" value="${item.title}" onchange="updateSummary(${index}, 'title', this.value)">
                        </div>
                        <a href="${item.link}" target="_blank" class="btn-link editable-value">ØªØ­Ù…ÙŠÙ„ â¬‡ï¸</a>
                    </div>
                    <div class="editable-field">
                        <input class="editable-input" value="${item.link}" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ù„Ù" onchange="updateSummary(${index}, 'link', this.value)">
                    </div>
                    <button class="btn-sm btn-delete" onclick="deleteSummary(${index})">Ø­Ø°Ù Ø§Ù„Ù…Ù„Ù</button>
                `;
                container.appendChild(div);
            });
        }
        function addSummary() {
            const title = document.getElementById('new-summ-title').value;
            const link = document.getElementById('new-summ-link').value;
            if(title && link) { 
                appData.summaries.push({ id: Date.now(), title, link }); 
                document.getElementById('new-summ-title').value=''; 
                document.getElementById('new-summ-link').value=''; 
                saveData();
                render();
            }
        }
        function updateSummary(index, key, val) { appData.summaries[index][key] = val; saveData(); render(); }
        function deleteSummary(index) { if(confirm('Ø­Ø°Ù Ø§Ù„Ù…Ù„ÙØŸ')) { appData.summaries.splice(index, 1); saveData(); render(); } }

        function renderLiveLinks() {
            const container = document.getElementById('live-list');
            container.innerHTML = '';
            const links = appData.liveLinks[selectedSection] || {};
            // Add quick controls: add new subject
            appData.subjects.forEach(sub => {
                const entry = links[sub] && typeof links[sub] === 'object' ? links[sub] : { link: '', from: '', to: '' };
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <h3>${sub}</h3>
                        ${entry.link ? `<a href="${entry.link}" target="_blank" class="btn-link editable-value">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø­ØµØ© ğŸ”´</a>` : '<span class="editable-value" style="color:gray">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø·</span>'}
                        <p class="editable-value session-info">Ù…ÙˆØ¹Ø¯ Ø§Ù„Ø­ØµØ©: ${entry.from || '--'} Ø¥Ù„Ù‰ ${entry.to || '--'}</p>
                    </div>
                    <div class="editable-field">
                        <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø­ØµØ© (Zoom/Teams):</label>
                        <input type="text" class="editable-input" value="${entry.link}" placeholder="Ø§Ù„ØµÙ‚ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§" onchange="updateLiveLink('${sub}', 'link', this.value)">
                        <div style="display:flex; gap:10px; margin-top:8px;">
                            <div style="flex:1">
                                <label>Ù…Ù†:</label>
                                <input type="time" class="editable-input" value="${entry.from}" onchange="updateLiveLink('${sub}', 'from', this.value)">
                            </div>
                            <div style="flex:1">
                                <label>Ø¥Ù„Ù‰:</label>
                                <input type="time" class="editable-input" value="${entry.to}" onchange="updateLiveLink('${sub}', 'to', this.value)">
                            </div>
                        </div>
                        <div style="margin-top:8px; display:flex; gap:8px;">
                            <button class="btn-sm btn-delete" onclick="deleteLiveLink('${sub}')">Ø­Ø°Ù Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø¹Ø¨Ø©</button>
                            <button class="btn-sm btn-delete" onclick="deleteSubject('${sub}')">Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹</button>
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });
            // add-new-container for adding a new subject in live-links
            const addBox = document.createElement('div');
            addBox.className = 'add-new-container';
            addBox.innerHTML = `
                <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</h4>
                <input type="text" id="new-subject-name" class="editable-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©" style="margin-bottom:8px;">
                <button class="btn-sm btn-add" onclick="addSubject()">Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø©</button>
            `;
            container.appendChild(addBox);
        }
        function updateLiveLink(subject, key, val) {
            if(!appData.liveLinks[selectedSection]) appData.liveLinks[selectedSection] = {};
            let cur = appData.liveLinks[selectedSection][subject];
            if(!cur || typeof cur !== 'object') cur = { link: '', from: '', to: '' };
            cur[key] = val;
            appData.liveLinks[selectedSection][subject] = cur;
            saveData();
            render();
        }

        function deleteLiveLink(subject) {
            if(!appData.liveLinks[selectedSection]) appData.liveLinks[selectedSection] = {};
            if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø±Ø§Ø¨Ø· Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø§Ø¯Ø© ÙÙŠ Ø§Ù„Ø´Ø¹Ø¨Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŸ')) {
                appData.liveLinks[selectedSection][subject] = { link: '', from: '', to: '' };
                saveData();
                render();
            }
        }

        function deleteSubject(subject) {
            if(!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø§Ø¯Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø¹Ø¨ØŸ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ© Ø³ØªØ­Ø°Ù Ø§Ù„ØªÙ‚Ø¯Ù… ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø§Ø¯Ø©.')) return;
            const idx = appData.subjects.indexOf(subject);
            if(idx > -1) appData.subjects.splice(idx, 1);
            // remove from progress and liveLinks across sections
            for(let i=1;i<=appData.sections;i++){
                if(appData.progress && appData.progress[i]) delete appData.progress[i][subject];
                if(appData.liveLinks && appData.liveLinks[i]) delete appData.liveLinks[i][subject];
            }
            saveData();
            render();
        }

        function addSubject() {
            const name = document.getElementById('new-subject-name').value.trim();
            if(!name) return;
            if(appData.subjects.includes(name)) { alert('Ø§Ù„Ù…Ø§Ø¯Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹'); return; }
            appData.subjects.push(name);
            // initialize progress and liveLinks for all sections
            for(let i=1;i<=appData.sections;i++){
                if(!appData.progress[i]) appData.progress[i] = {};
                appData.progress[i][name] = { current: 1, total: 20 };
                if(!appData.liveLinks[i]) appData.liveLinks[i] = {};
                appData.liveLinks[i][name] = { link: '', from: '', to: '' };
            }
            document.getElementById('new-subject-name').value = '';
            saveData();
            render();
        }

        // --- NEWS FUNCTIONS ---
        function renderNews() {
            const container = document.getElementById('news-list');
            container.innerHTML = '';
            if(appData.news.length === 0) {
                container.innerHTML = '<p style="color:var(--text-light); text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø¨Ø§Ø± Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                return;
            }
            appData.news.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <h3 class="editable-value">${item.title}</h3>
                        <button class="btn-sm btn-delete" onclick="deleteNews(${index})">Ø­Ø°Ù</button>
                    </div>
                    <p class="editable-value" style="color:var(--text-light); margin-bottom:10px;">${item.content}</p>
                    <div class="editable-field">
                        <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
                        <input class="editable-input" value="${item.title}" onchange="updateNews(${index}, 'title', this.value)" style="margin-bottom: 10px;">
                        <label>Ø§Ù„Ù…Ø­ØªÙˆÙ‰:</label>
                        <textarea class="editable-textarea" onchange="updateNews(${index}, 'content', this.value)" style="min-height: 80px;">${item.content}</textarea>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        function addNews() {
            const title = document.getElementById('new-news-title').value;
            const content = document.getElementById('new-news-content').value;
            if(title && content) {
                appData.news.push({ id: Date.now(), title, content });
                document.getElementById('new-news-title').value = '';
                document.getElementById('new-news-content').value = '';
                saveData();
                render();
            }
        }
        function updateNews(index, key, val) { appData.news[index][key] = val; saveData(); render(); }
        function deleteNews(index) { if(confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø®Ø¨Ø±ØŸ')) { appData.news.splice(index, 1); saveData(); render(); } }

        // --- IMPORTANT LINKS FUNCTIONS ---
        function renderImportantLinks() {
            const container = document.getElementById('important-links-list');
            container.innerHTML = '';
            if(appData.importantLinks.length === 0) {
                container.innerHTML = '<p style="color:var(--text-light); text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±ÙˆØ§Ø¨Ø· Ù…Ù‡Ù…Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                return;
            }
            appData.importantLinks.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <div>
                            <h3 class="editable-value">${item.title}</h3>
                            <input class="editable-field editable-input" value="${item.title}" onchange="updateImportantLink(${index}, 'title', this.value)">
                        </div>
                        <a href="${item.url}" target="_blank" class="btn-link editable-value">ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø· â†—ï¸</a>
                    </div>
                    <div class="editable-field">
                        <input class="editable-input" value="${item.url}" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø·" onchange="updateImportantLink(${index}, 'url', this.value)">
                    </div>
                    <button class="btn-sm btn-delete" onclick="deleteImportantLink(${index})">Ø­Ø°Ù</button>
                `;
                container.appendChild(div);
            });
        }
        function addImportantLink() {
            const title = document.getElementById('new-link-title').value;
            const url = document.getElementById('new-link-url').value;
            if(title && url) {
                appData.importantLinks.push({ id: Date.now(), title, url });
                document.getElementById('new-link-title').value = '';
                document.getElementById('new-link-url').value = '';
                saveData();
                render();
            }
        }
        function updateImportantLink(index, key, val) { appData.importantLinks[index][key] = val; saveData(); render(); }
        function deleteImportantLink(index) { if(confirm('Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø·ØŸ')) { appData.importantLinks.splice(index, 1); saveData(); render(); } }

        // --- TEAM FUNCTIONS ---
        function renderTeam() {
            const container = document.getElementById('team-list');
            container.innerHTML = '';
            if(appData.team.length === 0) {
                container.innerHTML = '<p style="color:var(--text-light); text-align:center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø£Ø¹Ø¶Ø§Ø¡ ÙÙŠ Ø§Ù„ÙØ±ÙŠÙ‚ Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                return;
            }
            appData.team.forEach((member, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <div>
                            <h3 class="editable-value">${member.name}</h3>
                            <input class="editable-field editable-input" value="${member.name}" onchange="updateTeam(${index}, 'name', this.value)">
                            <p class="editable-value" style="color:gray; font-size:0.9rem">${member.role}</p>
                            <input class="editable-field editable-input" value="${member.role}" onchange="updateTeam(${index}, 'role', this.value)">
                            <p class="editable-value" style="color:gray; font-size:0.85rem; margin-top:5px;">${member.bio || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª'}</p>
                            <textarea class="editable-field editable-textarea" onchange="updateTeam(${index}, 'bio', this.value)" style="min-height: 50px; margin-top: 5px;">${member.bio || ''}</textarea>
                        </div>
                        <div style="text-align:left;">
                            <a href="https://wa.me/${member.whatsapp}" target="_blank" class="btn-link editable-value">ÙˆØ§ØªØ³ ğŸ’¬</a>
                            <input class="editable-field editable-input" value="${member.whatsapp}" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³" onchange="updateTeam(${index}, 'whatsapp', this.value)">
                        </div>
                    </div>
                    <button class="btn-sm btn-delete" onclick="deleteTeamMember(${index})">Ø­Ø°Ù</button>
                `;
                container.appendChild(div);
            });
        }
        function addTeamMember() {
            const name = document.getElementById('new-team-name').value;
            const role = document.getElementById('new-team-role').value;
            const bio = document.getElementById('new-team-bio').value;
            const whatsapp = document.getElementById('new-team-whatsapp').value;
            console.log('addTeamMember called, name=', name, 'role=', role, 'whatsapp=', whatsapp);
            if(name && whatsapp) {
                appData.team.push({ id: Date.now(), name, role, bio, whatsapp });
                document.getElementById('new-team-name').value = '';
                document.getElementById('new-team-role').value = '';
                document.getElementById('new-team-bio').value = '';
                document.getElementById('new-team-whatsapp').value = '';
                saveData();
                render();
                // ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹ Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ø¶Ø§Ø¡ Ø§Ù„ÙØ±ÙŠÙ‚
                try { renderTeam(); } catch(e) { console.warn('renderTeam error', e); }
            }
        }
        function updateTeam(index, key, val) { appData.team[index][key] = val; saveData(); render(); }
        function deleteTeamMember(index) { if(confirm('Ø­Ø°Ù Ø¹Ø¶Ùˆ Ø§Ù„ÙØ±ÙŠÙ‚ØŸ')) { appData.team.splice(index, 1); saveData(); render(); } }

        // --- Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù… ---
        let booksPackagesType = 'books'; // 'books' or 'packages'

        function switchBooksPackagesType(type) {
            booksPackagesType = type;
            document.getElementById('booksTab').classList.toggle('active', type === 'books');
            document.getElementById('packagesTab').classList.toggle('active', type === 'packages');
            document.getElementById('add-books-packages-title').innerText = type === 'books' ? 'Ø¥Ø¶Ø§ÙØ© ÙƒØªØ§Ø¨ Ø¬Ø¯ÙŠØ¯' : 'Ø¥Ø¶Ø§ÙØ© Ø±Ø²Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©';
            document.getElementById('new-books-packages-title').placeholder = type === 'books' ? 'Ø§Ø³Ù… Ø§Ù„ÙƒØªØ§Ø¨' : 'Ø§Ø³Ù… Ø§Ù„Ø±Ø²Ù…Ø©';
            renderBooksPackages();
        }

        function renderBooksPackages() {
            const container = document.getElementById('books-packages-list');
            container.innerHTML = '';
            const list = booksPackagesType === 'books' ? appData.books : appData.packages;
            if (!list || list.length === 0) {
                container.innerHTML = `<p style="color:var(--text-light); text-align:center;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ${booksPackagesType === 'books' ? 'ÙƒØªØ¨' : 'Ø±Ø²Ù…'} Ø­Ø§Ù„ÙŠØ§Ù‹.</p>`;
                return;
            }
            list.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'data-card';
                div.innerHTML = `
                    <div class="data-header">
                        <h3 class="editable-value">${item.title}</h3>
                        <a href="${item.link}" target="_blank" class="btn-link editable-value">ØªØ­Ù…ÙŠÙ„ â¬‡ï¸</a>
                        <button class="btn-sm btn-delete" onclick="deleteBooksPackage(${index})">Ø­Ø°Ù</button>
                    </div>
                    <div class="editable-field">
                        <input class="editable-input" value="${item.title}" placeholder="Ø§Ù„Ø§Ø³Ù…" onchange="updateBooksPackage(${index}, 'title', this.value)">
                        <input class="editable-input" value="${item.link}" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØªØ­Ù…ÙŠÙ„" onchange="updateBooksPackage(${index}, 'link', this.value)">
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function addBooksPackage() {
            const title = document.getElementById('new-books-packages-title').value;
            const link = document.getElementById('new-books-packages-link').value;
            console.log('addBooksPackage called, type=', booksPackagesType, 'title=', title, 'link=', link);
            if(title && link) {
                let arr = booksPackagesType === 'books' ? appData.books : appData.packages;
                if(!arr) {
                    if(booksPackagesType === 'books') appData.books = [];
                    else appData.packages = [];
                    arr = booksPackagesType === 'books' ? appData.books : appData.packages;
                }
                arr.push({ id: Date.now(), title, link });
                document.getElementById('new-books-packages-title').value = '';
                document.getElementById('new-books-packages-link').value = '';
                saveData();
                render();
                try { renderBooksPackages(); } catch(e) { console.warn('renderBooksPackages error', e); }
            }
        }

        function updateBooksPackage(index, key, val) {
            const arr = booksPackagesType === 'books' ? appData.books : appData.packages;
            arr[index][key] = val;
            saveData();
            render();
            renderBooksPackages();
        }

        function deleteBooksPackage(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø­Ø°ÙØŸ')) {
                const arr = booksPackagesType === 'books' ? appData.books : appData.packages;
                arr.splice(index, 1);
                saveData();
                render();
                renderBooksPackages();
            }
        }

        // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø¥Ø°Ø§ Ø¯Ø®Ù„Øª Ù‚Ø³Ù… Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ø±Ø²Ù…ØŒ ÙØ¹Ù‘Ù„ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ÙƒØªØ¨ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
        document.addEventListener('DOMContentLoaded', function() {
            switchBooksPackagesType('books');
            render();
        });

        // Ensure functions are reachable from inline onclick handlers (debugging helpers)
        window.addAssignment = addAssignment;
        window.addBooksPackage = addBooksPackage;
        window.addTeamMember = addTeamMember;
        window.addSupport = addSupport;
        window.addSummary = addSummary;
        window.addNews = addNews;
        window.addImportantLink = addImportantLink;

        render();
    </script>


</body>
</html>